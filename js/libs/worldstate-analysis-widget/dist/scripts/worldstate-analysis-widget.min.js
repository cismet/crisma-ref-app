angular.module("eu.crismaproject.worldstateAnalysis.demoApp",["eu.crismaproject.worldstateAnalysis.demoApp.controllers","eu.crismaproject.worldstateAnalysis.directives","eu.crismaproject.worldstateAnalysis.services","de.cismet.crisma.widgets.worldstateTreeWidget","mgcrea.ngStrap"]),angular.module("eu.crismaproject.worldstateAnalysis.demoApp.controllers",["de.cismet.crisma.ICMM.Worldstates","de.cismet.cids.rest.collidngNames.Nodes","LocalStorageModule"]).controller("eu.crismaproject.worldstateAnalysis.demoApp.controllers.MainController",["$scope","de.cismet.collidingNameService.Nodes","de.cismet.crisma.ICMM.Worldstates","localStorageService","$timeout",function(a,b,c,d,e){"use strict";var f,g;a.forCriteriaTable=!1,a.chartModels=[],f=function(){var b,c;if(a.chartModels=[],a.worldstates&&a.worldstates.length>0)for(b=0;b<a.worldstates.length;b++)c=[],a.worldstates[b]&&c.push(a.worldstates[b]),a.worldstateRef&&(c=c.concat(a.worldstateRef)),a.chartModels.push(c)},g=function(){var b,d,e,f,g,h,i,j,k;if(k=function(b,c,d){h===b.displayName&&(j=!1),c===d.length-1&&j&&a.indicatorVector.push(i)},a.worldstates&&a.worldstates.length>0)for(g=0;g<a.worldstates.length;g++){e=c.utils.stripIccData([a.worldstates[g]],!1)[0];for(b in e.data)if(e.data.hasOwnProperty(b)){f=e.data[b];for(d in f)f.hasOwnProperty(d)&&"displayName"!==d&&"iconResource"!==d&&(a.indicatorVector.length>0?(h=f[d].displayName,i=f[d],j=!0,a.indicatorVector.forEach(k)):a.indicatorVector.push(f[d]))}}},a.persistCriteriaFunctions=function(){a.showPersistSpinner=!0,a.showPersistDone=!1,e(function(){d.add("criteriaFunctionSet",a.criteriaFunctionSets),a.showPersistSpinner=!1,a.showPersistDone=!0,e(function(){a.showPersistDone=!1},1500)},500)},c.query({level:5},function(b){a.allWorldstates=b}),a.$watch("worldstateRef",function(a,b){a!==b&&(f(),g())}),a.$watch("worldstates",function(b,c){b!==c&&a.worldstates&&(f(),g())},!0),a.indicatorVector=[],a.criteriaFunctionSet=d.get("criteriaFunctionSet")||[],a.criteriaFunctionSets=a.criteriaFunctionSet,a.selectedCriteriaFunction=a.criteriaFunctionSet[0],a.$watch("criteriaFunctionSet",function(a,b){a!==b&&console.log("received changes in criteria function")},!0),a.showDsPersistSpinner=!1,a.showDsPersistDone=!1,a.decisionStrategies=d.get("decisionStrategies")||[],a.selectedDecisionStrategy=a.decisionStrategies[0],a.persistDecisionStrategies=function(){a.showDsPersistSpinner=!0,a.showDsPersistDone=!1,e(function(){d.add("decisionStrategies",a.decisionStrategies),a.showDsPersistSpinner=!1,a.showDsPersistDone=!0,e(function(){a.showDsPersistDone=!1},1500)},500)},a.activeItem={},a.treeOptions={checkboxClass:"glyphicon glyphicon-unchecked",folderIconClosed:"icon-world.png",folderIconOpen:"icon-world.png",leafIcon:"icon-world.png",imagePath:"bower_components/crisma-worldstate-tree-widget-angular/dist/images/",multiSelection:!0},a.treeSelection=[],a.$watchCollection("treeSelection",function(b,d){var e,f,g,h=[],i=function(b){h.push(b),h.length===a.treeSelection.length&&(a.worldstates?a.worldstates.splice(0,a.worldstates.length):a.worldstates=[],a.worldstates=h)};if(b!==d)for(a.treeSelection.length<=0&&a.worldstates.splice(0,a.worldstates.length),e=0;e<a.treeSelection.length;e++)g=a.treeSelection[e].objectKey,f=g.substring(g.lastIndexOf("/")+1,g.length),c.get({wsId:f},i)}),a.updateSelectedCriteriaFunction=function(b){a.selectedCriteriaFunction=a.criteriaFunctionSet[b]},a.updateSelectedDecisionStrategy=function(b){a.selectedDecisionStrategy=a.decisionStrategies[b]},a.indicatorVector=[],a.treeNodes=b.query(function(){var b,d,e,f,g;d=a.treeNodes[0].objectKey,b=d.substring(d.lastIndexOf("/")+1,d.length),e=c.get({wsId:b},function(){var b,d;f=c.utils.stripIccData([e],!1)[0];for(b in f.data)if(f.data.hasOwnProperty(b)){g=f.data[b];for(d in g)g.hasOwnProperty(d)&&"displayName"!==d&&"iconResource"!==d&&a.indicatorVector.push(g[d])}})})}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers",["nvd3ChartDirectives","eu.crismaproject.worldstateAnalysis.services","ngDialog"]).controller("eu.crismaproject.worldstateAnalysis.controllers.IndicatorCriteriaTableDirectiveController",["$scope","$filter","de.cismet.crisma.ICMM.Worldstates","ngTableParams","eu.crismaproject.worldstateAnalysis.services.CriteriaCalculationService",function(a,b,c,d,e){"use strict";var f=function(a){var b,c;c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b);return c.sort(),c},g=function(){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;if(u=c.utils.stripIccData(a.worldstates),a.worldstates&&0!==a.worldstates.length){for(a.rows=[],a.columns=[{title:a.forCriteria?"Level of satisfaction (higher is better)":"Indicators",field:"f1",visible:!0}],k=0,j=u[0].data,n=f(j),l=0;l<n.length;++l)for(h=j[n[l]],a.rows[k++]={f1:{name:h.displayName,icon:h.iconResource}},o=f(h),m=0;m<o.length;++m)p=o[m],"displayName"!==p&&"iconResource"!==p&&(a.rows[k++]={f1:{name:h[p].displayName,icon:h[p].iconResource}});for(i=0;i<u.length;++i)for(g="f"+(i+2),a.columns.push({title:u[i].name,field:g,visible:!0}),j=u[i].data,k=0,n=f(j),l=0;l<n.length;++l)for(h=j[n[l]],a.rows[k++][g]=null,o=f(h),m=0;m<o.length;++m)if(p=o[m],t=a.forCriteria?"% LoS":h[p].unit,"displayName"!==p&&"iconResource"!==p){for(s=0;s<a.criteriaFunction.criteriaFunctions.length;s++)if(a.criteriaFunction.criteriaFunctions[s].indicator===h[p].displayName){r=a.criteriaFunction.criteriaFunctions[s];break}q=a.forCriteria?e.calculateCriteria(h[p].value,r):h[p].value,q%1!==0&&(q=b("number")(q,2)),a.rows[k++][g]={name:q+" "+t}}}a.tableParams?a.tableParams.reload():a.tableParams=new d({page:1,count:1e4},{counts:[],total:a.worldstates.length,getData:function(b,c){return a.worldstates.length<=0?null:void b.resolve(a.rows.slice((c.page()-1)*c.count(),c.page()*c.count()))}})};a.tableVisibleSwitch="0",a.isGroupRow=function(a){return null===a.f2},a.getRowStyle=function(b){var c=a.rows[b],d={"font-weight":"bold"};return a.isGroupRow(c)?d:""},a.getCellStyle=function(a){var b={"text-align":"right"};return a>0?b:""},a.$watchCollection("worldstates",function(){a.worldstates&&g()}),a.$watch("forCriteria",function(b,c){b!==c&&a.worldstates&&g()}),a.$watch("criteriaFunction",function(b,c){b!==c&&a.worldstates&&g()},!0)}]),angular.module("eu.crismaproject.worldstateAnalysis.directives",["eu.crismaproject.worldstateAnalysis.controllers","ngTable","de.cismet.crisma.ICMM.Worldstates","mgcrea.ngStrap.popover"]).directive("indicatorCriteriaTable",[function(){"use strict";var a;return a={worldstates:"=",forCriteria:"=",criteriaFunction:"=",detailIcons:"@"},{scope:a,restrict:"E",templateUrl:"templates/indicatorCriteriaTableTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.IndicatorCriteriaTableDirectiveController"}}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("knob",function(){"use strict";return{restrict:"EACM",template:function(){return'<input ng-model="knobData">'},replace:!0,scope:{knobData:"=",knobOptions:"="},link:function(a,b){var c=function(){var c,d;d=a.knobOptions||{max:100,width:100,height:100,displayInput:!1,angleOffset:-125,angleArc:250},d.release=function(b){a.knobData=b,a.$apply()},c=b,c.val(a.knobData),c.knob(d),b.find("div").css("display","block").css("margin","0 auto")};a.$watch("knobData",function(){c()},!0),a.$watch("knobOptions",function(){c()})}}}),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.CriteriaRadarChartDirectiveController",["$scope","eu.crismaproject.worldstateAnalysis.services.CriteriaCalculationService",function(a,b){"use strict";a.legendItems=[],a.convertToChartDataStructure=function(c){var d,e,f,g,h,i,j,k,l,m,n;for(k=[],m=[],d=0;d<c.length;d++){l=[],f=c[d].data,m.push(c[d].name);for(g in f)if(f.hasOwnProperty(g)){h=f[g];for(i in h)if(h.hasOwnProperty(i)&&"displayName"!==i&&"iconResource"!==i){for(j=h[i],e=0;e<a.criteriaFunction.criteriaFunctions.length;e++)if(a.criteriaFunction.criteriaFunctions[e].indicator===j.displayName){n=a.criteriaFunction.criteriaFunctions[e];break}l.push({axis:a.useNumbers?l.length+1:j.displayName,tooltip:j.displayName,value:Math.round(100*b.calculateCriteria(j.value,n))/100})}}k.push(l)}return[k,m]}}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("criteriaRadar",["de.cismet.crisma.ICMM.Worldstates",function(a){"use strict";var b,c,d,e;return b={localModel:"&worldstates",criteriaFunction:"=",showLegend:"=",showAxisText:"=",useNumbers:"="},e=function(a){d3.select(a[0]).selectAll("circle").select("title").text(function(a){return a.tooltip+": "+Math.max(a.value,0)})},d=function(a,b,c){var d,e,f,g,h,i,j,k,l;d=d3.scale.category10(),e=d3.select(a[0]).append("div").append("svg").attr("width",b.w).attr("height",5),f=e.append("g").attr("class","legend").attr("height",5).attr("width",50),g=f.selectAll("rect").data(c).enter().append("rect").attr("y",15).attr("x",0).attr("width",10).attr("height",10).style("fill",function(a,b){return d(b)}),i=f.selectAll("text").data(c).enter().append("text").attr("y",24).attr("x",0).attr("font-size","11px").attr("fill","#737373").text(function(a){return a}),h=[],j=[],k=0,l=0,i.attr("transform",function(a,c){var d,e,f,g,i;return d=d3.select(this).node().getBBox().width,e=j.reduce(function(a,b){return a+b},0),j.push(d),h.push(d),f=15*(c-k+1),g=20*(c-k),i=e+f+g,i+d>b.w&&(l+=20,k=c,j=[d],i=15),"translate("+i+","+l+")"}),l=0,k=0,g.attr("transform",function(a,c){var d,e,f,g;return d=h.reduce(function(a,b,d){return c>d&&d>=k?a+b:a},0),e=15*(c-k),f=20*(c-k),g=d+e+f,g+h[c]+15>b.w&&(l+=20,k=c,g=0),"translate("+g+","+l+")"}),e.attr("height",l+50),f.attr("height",l+50),f.attr("transform",function(){var a,c;return a=d3.select(this).node().getBBox().width,c=(b.w-a)/2,c=0>c?0:c,"translate("+c+",0)"})},c=function(b,c){var f,g,h;h=function(){var g,h;if(c.removeData(),c.empty(),b.localModel()&&b.localModel().length>0){g=a.utils.stripIccData(b.localModel(),!1),h=b.convertToChartDataStructure(g),b.chartData=h[0],b.legendItems=h[1];var i=d3.select(c[0]).append("div").attr("style","display:block;margin: 0 auto;").node();RadarChart.draw(i,b.chartData,f),b.showLegend&&d(c,f,b.legendItems),b.useNumbers&&e(c,f,b.legendItems)}},g=c.width?c.width():200,f={w:g,h:g,maxValue:100,levels:4,axisText:angular.isDefined(b.showAxisText)&&b.showAxisText?!0:!1,showTooltip:b.useNumbers},b.$watchCollection("localModel()",h),b.$watch("criteriaFunction",h,!0)},{scope:b,restrict:"AE",link:c,controller:"eu.crismaproject.worldstateAnalysis.controllers.CriteriaRadarChartDirectiveController"}}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.IndicatorCriteriaAxisChooserDirectiveController",["$scope",function(a){"use strict";var b,c,d;c="true"===a.isXAxis,d={name:c?"Select a x-axis":"Select a y-axis"},b=function(a){var b,c,d,e=[];if(a){var f=a.data;for(b in f)if(f.hasOwnProperty(b)){c=f[b],e.push({name:c.displayName,icon:c.iconResource,isGroup:!0});for(d in c)c.hasOwnProperty(d)&&"displayName"!==d&&"iconResource"!==d&&e.push({name:c[d].displayName,icon:c[d].iconResource,isGroup:!1})}}return e},a.selectedAxis||(a.selectedAxis=d),a.scales=[],a.axisSelected=function(b){a.selectedAxis=a.scales[b]?a.scales[b]:d},a.$watch("iccObject",function(){a.iccObject&&(a.scales=b(a.iccObject))})}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("indicatorCriteriaAxisChooser",[function(){"use strict";var a;return a={iccObject:"=",isXAxis:"@",selectedAxis:"="},{scope:a,restrict:"E",templateUrl:"templates/indicatorCriteriaAxisChooserTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.IndicatorCriteriaAxisChooserDirectiveController"}}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.RelationAnalysisChartDirectiveController",["$scope","de.cismet.crisma.ICMM.Worldstates","eu.crismaproject.worldstateAnalysis.services.CriteriaCalculationService",function(a,b,c){"use strict";var d=this;this.createChartData=function(a,b,c,e,f,g){var h,i,j,k,l=[];if(!a||!b||!c)throw"Invalid configuration. Can no determine chart data for (iccData, xAxis, yaxis):"+a+" , "+b+" , "+c;var m=0;for(h=0;h<a.length;h++){if(i=a[h],!i)throw"Invalid icc object "+i;j=d.getDataValueForAxis(b,i,e,g),k=d.getDataValueForAxis(c,i,f,g),0===m&&(m=j),l.push({key:h+1+". "+a[h].name,values:[{x:j,y:k}]})}return l},this.getDataValueForAxis=function(a,b,d,e){var f,g,h,i,j;if(!a||!a.name)return null;f=a.name,g=b.data;for(j in g)if(g.hasOwnProperty(j)){h=g[j];for(i in h)if(h.hasOwnProperty(i)&&h[i].displayName===f)return e?c.calculateCriteria(h[i].value,d):h[i].value}return null},a.getXAxisLabel=function(){var b="";return a.xAxis&&a.xAxis.name&&(b=a.xAxis.name),b},a.getYAxisLabel=function(){var b="";return a.yAxis&&a.yAxis.name&&(b=a.yAxis.name),b},a.zScale=d3.scale.linear(),a.yAxisTickFormatFunction=function(){return function(a){return d3.round(a,2)}},a.xAxisTickFormatFunction=function(){return function(a){return d3.round(a,2)}},this.dataChangedWatchCallback=function(){a.worldstates()&&a.worldstates().length>0&&(a.iccData=b.utils.stripIccData(a.worldstates()),a.iccObject=a.iccData[0],a.xAxis&&a.yAxis&&-1===a.xAxis.name.indexOf("Select")&&-1===a.yAxis.name.indexOf("Select")&&(a.chartdata=d.createChartData(a.iccData,a.xAxis,a.yAxis,a.xAxisCriteriaFunction,a.yAxisCriteriaFunction,a.forCriteria)))},this.updateAxisCriteriaFunctions=function(){var b;for(b=0;b<a.criteriaFunctionSet.criteriaFunctions.length;b++)a.criteriaFunctionSet.criteriaFunctions[b].indicator===a.xAxis.name&&(a.xAxisCriteriaFunction=a.criteriaFunctionSet.criteriaFunctions[b]),a.criteriaFunctionSet.criteriaFunctions[b].indicator===a.yAxis.name&&(a.yAxisCriteriaFunction=a.criteriaFunctionSet.criteriaFunctions[b])},this.axisWatchCallback=function(){a.xAxis&&a.yAxis&&-1===a.xAxis.name.indexOf("Select")&&-1===a.yAxis.name.indexOf("Select")&&(a.criteriaFunctionSet&&d.updateAxisCriteriaFunctions(),a.chartdata=d.createChartData(a.iccData,a.xAxis,a.yAxis,a.xAxisCriteriaFunction,a.yAxisCriteriaFunction,a.forCriteria))},a.$watch("xAxis",this.axisWatchCallback),a.$watch("yAxis",this.axisWatchCallback),a.$watch("forCriteria",this.dataChangedWatchCallback),a.$watch("worldstates()",this.dataChangedWatchCallback),a.$watch("criteriaFunctionSet",this.axisWatchCallback,!0)}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("relationAnalysisChart",["de.cismet.crisma.ICMM.Worldstates",function(){"use strict";var a;return a={worldstates:"&",chartHeight:"@height",forCriteria:"=",criteriaFunctionSet:"=criteriaFunction"},{scope:a,restrict:"E",templateUrl:"templates/relationAnalysisChartTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.RelationAnalysisChartDirectiveController"}}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.IndicatorBandDirectiveController",["$scope","eu.crismaproject.worldstateAnalysis.services.CriteriaCalculationService",function(a,b){"use strict";var c,d;c={lowerBoundary:{criteriaValue:0,indicatorValue:0},upperBoundary:{criteriaValue:100,indicatorValue:0},intervals:[]},d=function(a,b){return a.criteriaValue-b.criteriaValue},a.criteriaFunction||(a.criteriaFunction=c),a.criteriaFunction.lowerBoundary=a.criteriaFunction.lowerBoundary||c.lowerBoundary,a.criteriaFunction.upperBoundary=a.criteriaFunction.upperBoundary||c.upperBoundary,a.criteriaFunction.intervals=a.criteriaFunction.intervals?a.criteriaFunction.intervals.sort(d)||c.intervals.sort(d):c.intervals.sort(d),a.$watch("criteriaFunction",function(){a.criteriaFunction&&(a.criteriaFunction.lowerBoundary=a.criteriaFunction.lowerBoundary||c.lowerBoundary,a.criteriaFunction.upperBoundary=a.criteriaFunction.upperBoundary||c.upperBoundary,a.criteriaFunction.intervals=a.criteriaFunction.intervals?a.criteriaFunction.intervals.sort(d)||c.intervals.sort(d):c.intervals.sort(d))},!0),a.getIntervalColor=function(c){var d,e;switch(e=b.getColor(c,a.criteriaFunction)){case"#B5F4BC":d="color-b";break;case"#FFBA6B":d="color-c";break;case"#FF9F80":d="color-d";break;case"#FFC48C":d="color-e";break;case"#FFDC8A":d="color-f";break;case"#FFF19E":d="color-g";break;case"#EFFAB4":d="color-h";break;case"#D1F2A5":d="color-i"}return d},a.deleteInterval=function(b){var c=a.criteriaFunction.intervals.indexOf(b);a.criteriaFunction.intervals.splice(c,1)},a.updateLowerBoundary=function(b){a.criteriaFunction.lowerBoundary.indicatorValue=b},a.updateUpperBoundary=function(b){a.criteriaFunction.upperBoundary.indicatorValue=b},a.$on("band-item-removed",function(b,c){b.targetScope!==a?a.$broadcast("band-item-removed"):a.deleteInterval(c)}),a.createInterval=function(b,c){var e={criteriaValue:b,indicatorValue:c};a.criteriaFunction.intervals.push(e),a.criteriaFunction.intervals.sort(d),a.$broadcast("band-item-added")},a.getIntervalWidth=function(a,b){var c=0;return b&&(c=b.criteriaValue||0),a&&a.criteriaValue?{width:a.criteriaValue-c+"%"}:{width:100-c+"%"}}}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.IndicatorBandItemDirectiveController",["$scope","$filter","$element","$timeout",function(a,b,c,d){"use strict";a.actualHeightExceeded=!1,a.getElementHeight=function(){return c.height()},a.getElementWidth=function(){return c.width()},a.checkActualHeight=function(){d(function(){var b=a.lowerBoundary||a.upperBoundary?c.children()[0]:c.children()[1];angular.element(b).height()>angular.element(c.parent()).height()?a.actualHeightExceeded=!0:(a.actualHeightExceeded&&d(function(){a.checkActualHeight()}),a.actualHeightExceeded=!1)},500)},a.actualHeightExceeded=!1,a.checkActualHeight(),a.$on("band-item-added",function(){a.checkActualHeight()}),a.$on("band-item-removed",function(){a.checkActualHeight()}),a.getCriteriaSuggestion=function(){var b;return b=!a.interval||a.upperBoundary?100:a.lowerBoundary?0:a.previousInterval?a.previousInterval.criteriaValue+(a.interval.criteriaValue-a.previousInterval.criteriaValue)/2:a.interval.criteriaValue/2},a.$on("tooltip.show.before",function(){a.popOverItem.criteriaValue=a.getCriteriaSuggestion(),a.popOverItem.indicatorValue=b("number")(a.interval.indicatorValue||0)}),a.minWidth=80;var e=a.interval?a.interval.indicatorValue||0:0;a.popOverItem={criteriaValue:a.getCriteriaSuggestion(),indicatorValue:b("number")(e)},a.getPercent=function(){var b=0;if(a.lowerBoundary||a.upperBoundary)return 100;if(a.previousInterval&&(b=a.previousInterval.criteriaValue||0),a.interval&&(a.interval.criteriaValue||0===a.interval.criteriaValue)){if(b>a.interval.criteriaValue)throw new Error("The criteriaValue of the previous interval can not be higher than the criteriaValue of the current Interval");return a.interval.criteriaValue-b}if(b>100)throw new Error("The criteriaValue of the previous interval can not be higher than the criteriaValue of the current Interval");return 100-b},a.intervalWidth=function(){var b=a.getPercent();return{width:b+"%"}},a.getColorClass=function(){return a.lowerBoundary?"color-a":a.upperBoundary?"color-j":a.getColor({interval:a.interval})},a.del=function(b){a.$emit("band-item-removed",b)},a.updateInterval=function(b){a.onIntervalChanged({criteriaValue:parseFloat(a.popOverItem.criteriaValue),indicatorValue:parseFloat(a.popOverItem.indicatorValue)}),a.hidePopover(),b.stopPropagation()},a.getTooltipTitle=function(){var b="";return b+="Criteria: ",b+=a.lowerBoundary?"0%":a.upperBoundary?"100%":(a.previousInterval.criteriaValue||"0")+"% -"+a.interval.criteriaValue+"%",b+="Indicator Values: ",b+=a.lowerBoundary?"<= "+(a.interval?a.interval.indicatorValue||0:0):a.upperBoundary?">= "+(a.interval?a.interval.indicatorValue||0:0):(a.interval?a.interval.indicatorValue||0:0)+"- "+a.interval.indicatorValue},a.previousInterval&&a.interval&&(a.tooltip={title:a.getTooltipTitle(),checked:!1})}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("indicatorBand",[function(){"use strict";var a;return a={criteriaFunction:"=?"},{scope:a,restrict:"E",templateUrl:"templates/indicatorBandTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.IndicatorBandDirectiveController"}}]).directive("indicatorBandItem",["$popover",function(a){"use strict";var b;return b={interval:"=",previousInterval:"=",first:"=",last:"=",lowerBoundary:"@",upperBoundary:"@",onIntervalChanged:"&",getColor:"&"},{scope:b,restrict:"E",templateUrl:"templates/indicatorBandItemTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.IndicatorBandItemDirectiveController",replace:!0,link:function(b,c,d){var e=a(c.find("#popover-target"),{scope:b,title:d.title||"Create a new interval",template:"templates/indicatorBandPopoverTemplate.html",contentTemplate:"templates/indicatorBandPopoverContentTemplate.html",placement:"bottom",trigger:"manual"});b.togglePopover=function(){e.$promise.then(e.toggle)},b.hidePopover=function(){e.$promise.then(e.hide)}}}}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.CriteriaFunctionManagerDirectiveController",["$scope",function(a){"use strict";a.editable=[],a.currentIntervalFunctions=[],a.selectedCriteriaFunctionIndex=-1,a.tooltipDelete={title:"Delete this criteria function"},a.tooltipAdd={title:"Create a new criteria function"},a.tooltipSave={title:"Save changes"},a.tooltipRename={title:"Rename criteria function"},a.tooltipRenameDone={title:"Done"},a.addCriteriaFunction=function(){var b,c=[];for(b=0;b<a.indicators.length;b++)c.push({indicator:a.indicators[b].displayName,lowerBoundary:{criteriaValue:0,indicatorValue:0},upperBoundary:{criteriaValue:100,indicatorValue:0},intervals:[]});a.criteriaFunctionSet.push({name:"Criteria function "+(a.criteriaFunctionSet.length+1),criteriaFunctions:c}),a.editable.push(!1)},a.removeCriteriaFunction=function(){a.criteriaFunctionSet.splice(a.selectedCriteriaFunctionIndex,1)},a.isActiveItem=function(b){return a.selectedCriteriaFunctionIndex===b?"list-group-item-info":""},a.setSelectedCriteriaFunction=function(b){a.selectedCriteriaFunctionIndex=b,a.currentCriteriaFunction=a.criteriaFunctionSet[a.selectedCriteriaFunctionIndex]}}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("criteriaFunctionManager",[function(){"use strict";var a;return a={indicators:"=",criteriaFunctionSet:"=criteriaFunctions"},{scope:a,restrict:"E",templateUrl:"templates/criteriaFunctionManagerTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.CriteriaFunctionManagerDirectiveController"}}]),angular.module("eu.crismaproject.worldstateAnalysis.services",[]).factory("eu.crismaproject.worldstateAnalysis.services.AnalysisService",[function(){"use strict";var a;return a=function(){var b,c,d,e,f,g,h;return d=1e-7,f=1e6,h=this,g={},e=function(a,b,c){return Math.abs(a-b)<c},c=function(a){var b;for(b=0;b<a.length;++b)if(a[b]<0||a[b]>1)throw"arg value not within range [0, 1]: arg["+b+"]="+a[b]},b=function(a){var b,f;for(c(a),f=0,b=0;b<a.length;++b)f+=a[b];if(!e(f,1,d))throw"sum of vector is not 1: "+f},g.orness=function(a){var c,d,e;for(b(a),d=a.length,e=0,c=0;c<a.length;++c)e+=(d-(c+1))*a[c];return e*=1/(d-1)},g.dispersion=function(a){var c,d;for(b(a),d=0,c=0;c<a.length;++c)0!==a[c]&&(d+=a[c]*Math.log(a[c]));return d*=-1},g.lLSWeights=function(a){var c,d,e;for(d=0,c=1;a>=c;++c)d+=Math.pow(c,Math.E);for(e=[],c=1;a>=c;++c)e[c-1]=Math.pow(c,Math.E)/d;return b(e),e},g.hLSWeights=function(b){return a.lLSWeights(b).reverse()},g.meanWeights=function(b){var c,f,g,h;for(g=1/b,h=[],c=0;b>c;++c)h[c]=g;if(f=a.dispersion(h),!e(f,Math.log(b),d))throw"rounding error: [dispersion="+f+"|log="+Math.log(b)+"]";return h},g.orderedArgs=function(a){return a.slice(0).sort().reverse()},g.aggregateLS=function(d,e,f){var g,h,i,j,k,l,m,n,o,p;if(b(e),c(d),d.length!==e.length)throw"criteria and weights must have the same amount of items";if(f){if(c(f),d.length!==f.length)throw"criteria and importance must have the same amount of items";for(g=[],o=a.orness(e),k=1-o,h=0;h<f.length;++h)l=f[h],p=d[h],m=Math.max(l,k),n=Math.max(l,o),j=m*Math.pow(p,n),g[h]=j}else g=d;for(i=a.orderedArgs(g),j=0,h=0;h<i.length;++h)j+=i[h]*e[h];return j},g}(),{getOwa:function(){return a}}}]),angular.module("eu.crismaproject.worldstateAnalysis.services").factory("eu.crismaproject.worldstateAnalysis.services.CriteriaCalculationService",[function(){"use strict";var a,b,c,d;return b=function(a,b,c){var d,e,f,g,h;return d=Math.max(b.indicatorValue,c.indicatorValue),e=Math.min(b.indicatorValue,c.indicatorValue),f=b.criteriaValue,g=c.criteriaValue,h=(d-a)/(d-e),g+(f-g)*h},a=function(a,c){var d,e,f,g=[];if(!(c.lowerBoundary&&c.upperBoundary&&c.intervals))throw new Error("CriteriaFunction is not valid");if(g.push(c.lowerBoundary),g=g.concat(c.intervals),g.push(c.upperBoundary),c.lowerBoundary.indicatorValue>c.upperBoundary.indicatorValue&&g.reverse(),a<=g[0].indicatorValue)return g[0].criteriaValue;if(a>=g[g.length-1].indicatorValue)return g[g.length-1].criteriaValue;for(d=1;d<g.length;d++)if(e=g[d-1],f=g[d],a>=e.indicatorValue&&a<=f.indicatorValue)return b(a,e,f);return b(a,f,c.upperBoundary)},d=function(a,b){var d,e,f=null;if(0===a)return"#FF6543";if(100===a)return"#B5F4BC";if(b.intervals)for(d=0;d<b.intervals.length;d++)if(e=b.intervals[d],a<e.criteriaValue)return c(e,b);return c(f,b)},c=function(a,b){var c,d,e,f=b.intervals.length,g=-1;if(a)for(d=0;f>d;d++)c=b.intervals[d],c.criteriaValue===a.criteriaValue&&(g=d);return e=0===f?"#FFC48C":1===f?0===g?"#FF9F80":"#FFF19E":2===f?0===g?"#FFBA6B":1===g?"#FFDC8A":"#EFFAB4":3===f?0===g?"#FFBA6B":1===g?"#FFC48C":2===g?"#FFDC8A":"#EFFAB4":4===f?0===g?"#FFBA6B":1===g?"#FF9F80":2===g?"#FFDC8A":3===g?"#FFF19E":"#EFFAB4":5===f?0===g?"#FFBA6B":1===g?"#FF9F80":2===g?"#FFDC8A":3===g?"#FFF19E":4===g?"#EFFAB4":"#D1F2A5":0===g?"#FFBA6B":1===g?"#FF9F80":2===g?"#FFC48C":3===g?"#FFDC8A":4===g?"#FFF19E":5===g?"#EFFAB4":"#D1F2A5"},{calculateCriteria:a,getColor:c,getColorForCriteria:d}}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.WorldstateAnalysisWidgetDirectiveController",["$scope","de.cismet.crisma.ICMM.Worldstates","localStorageService","$timeout",function(a,b,c,d){"use strict";var e,f;a.forCriteriaTable=!0,a.chartModels=[],e=function(){var b,c;if(a.chartModels=[],a.worldstates&&a.worldstates.length>0)for(b=0;b<a.worldstates.length;b++)c=[],a.worldstates[b]&&c.push(a.worldstates[b]),a.worldstateRef&&(c=c.concat(a.worldstateRef)),a.chartModels.push(c)},f=function(){var c,d,e,f,g,h,i,j,k;if(k=function(b,c,d){h===b.displayName&&(j=!1),c===d.length-1&&j&&a.indicatorVector.push(i)},a.worldstates&&a.worldstates.length>0)for(g=0;g<a.worldstates.length;g++){e=b.utils.stripIccData([a.worldstates[g]],!1)[0];for(c in e.data)if(e.data.hasOwnProperty(c)){f=e.data[c];for(d in f)f.hasOwnProperty(d)&&"displayName"!==d&&"iconResource"!==d&&(a.indicatorVector.length>0?(h=f[d].displayName,i=f[d],j=!0,a.indicatorVector.forEach(k)):a.indicatorVector.push(f[d]))}}},a.persistCriteriaFunctions=function(){a.showPersistSpinner=!0,a.showPersistDone=!1,d(function(){c.add("criteriaFunctionSet",a.criteriaFunctionSets),a.showPersistSpinner=!1,a.showPersistDone=!0,d(function(){a.showPersistDone=!1},1500)},500)},b.query({level:5},function(b){a.allWorldstates=b}),a.$watch("worldstateRef",function(a,b){a!==b&&(e(),f())}),a.$watch("worldstates",function(b,c){b!==c&&a.worldstates&&(e(),f())},!0),a.indicatorVector=[]}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("worldstateAnalysisWidget",[function(){"use strict";var a;return a={worldstates:"=",criteriaFunctionSets:"=",selectedCriteriaFunction:"="},{scope:a,restrict:"E",templateUrl:"templates/worldstateAnalysisWidgetTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.WorldstateAnalysisWidgetDirectiveController"}}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.levelOfEmphasisDirectiveController",["$scope","eu.crismaproject.worldstateAnalysis.services.AnalysisService",function(a,b){"use strict";var c,d,e;c=this,d=b.getOwa(),this.updateLseVectors=function(){if(a.indicatorSize>=1){for(c.onlyPositiveLse=[],e=0;e<a.indicatorSize;e++)this.onlyPositiveLse[e]=0===e?1:0;for(c.overEmphPosLse=d.hLSWeights(a.indicatorSize<=1?1:a.indicatorSize),c.neutralLse=d.meanWeights(a.indicatorSize<=1?1:a.indicatorSize),c.overEmphNegLse=d.lLSWeights(a.indicatorSize<=1?1:a.indicatorSize),c.onlyNegativeLse=[],e=0;e<a.indicatorSize;e++)c.onlyNegativeLse[e]=e===a.indicatorSize-1?1:0}},this.updateSatisfactionEmphasis=function(a){var b;switch(parseInt(a)){case-2:b=c.onlyNegativeLse;break;case-1:b=c.overEmphNegLse;break;case 0:b=c.neutralLse;break;case 1:b=c.overEmphPosLse;break;case 2:b=c.onlyPositiveLse}return b},this.satisfactionEmphasisEquals=function(a,b){var c;if(a&&b&&a.length===b.length){for(c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}return!1},this.updateInternalModel=function(a){return c.satisfactionEmphasisEquals(a,this.onlyNegativeLse)?-2:c.satisfactionEmphasisEquals(a,this.overEmphNegLse)?-1:c.satisfactionEmphasisEquals(a,this.neutralLse)?0:c.satisfactionEmphasisEquals(a,this.overEmphPosLse)?1:c.satisfactionEmphasisEquals(a,this.onlyPositiveLse)?2:0},c.updateLseVectors(),a.indicatorSize>=1&&(a.model={lse:a.satisfactionEmphasis?c.updateInternalModel(a.satisfactionEmphasis):0}),a.satisfactionEmphasis=a.satisfactionEmphasis||c.updateSatisfactionEmphasis(0),a.$watch("model",function(b,d){b!==d&&a.indicatorSize>=1&&(a.satisfactionEmphasis=c.updateSatisfactionEmphasis(a.model.lse))},!0),a.$watch("satisfactionEmphasis",function(b,d){b!==d&&a.indicatorSize>=1&&(a.model.lse=c.updateInternalModel(a.satisfactionEmphasis))},!0),a.$watch("indicatorSize",function(){c.updateLseVectors(),a.indicatorSize>=1&&(a.model&&a.model.lse||(a.model={lse:a.satisfactionEmphasis?c.updateInternalModel(a.satisfactionEmphasis):0}),a.satisfactionEmphasis=c.updateSatisfactionEmphasis(a.model.lse))},!0)}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("levelOfEmphasis",[function(){"use strict";var a;return a={satisfactionEmphasis:"=",indicatorSize:"=",expertMode:"="},{scope:a,restrict:"E",templateUrl:"templates/levelOfEmphasisTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.levelOfEmphasisDirectiveController"}}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.criteriaEmphasesController",["$scope",function(a){"use strict";var b,c;b=this,this.updateCriteriaEmphases=function(){var b,c;for(b=0;b<a.critEmphInternal.length;b++)c=a.critEmphInternal[b],a.criteriaEmphases[b]?a.criteriaEmphases[b].criteriaEmphasis=c.criteriaEmphasis:a.criteriaEmphases.push({indicator:c.indicator,criteriaEmphasis:c.criteriaEmphasis})},this.updateInternalCriteriaEmphases=function(){var b,c,d;c=[];for(d in a.indicatorMap)a.indicatorMap.hasOwnProperty(d)&&(b=!1,a.criteriaEmphases&&0!==a.criteriaEmphases.length&&a.criteriaEmphases.forEach(function(e){e.indicator.displayName===a.indicatorMap[d].displayName&&(b=!0,c.push(e))}),b||c.push({indicator:a.indicatorMap[d],criteriaEmphasis:100}));a.critEmphInternal=c},this.registerInternalWatch=function(){c=a.$watch("critEmphInternal",function(a,c){a!==c&&b.updateCriteriaEmphases()},!0)},a.knobMax=100,a.knobOptions={width:100,height:80,displayInput:!0,angleOffset:-125,angleArc:250},a.criteriaEmphases=a.criteriaEmphases||[],a.indicatorMap={},a.$watch("indicatorMap",function(){a.indicatorMap&&0!==Object.keys(a.indicatorMap).length&&b.updateInternalCriteriaEmphases()},!0),a.$watch("criteriaEmphases",function(d,e){d!==e&&(c(),b.updateInternalCriteriaEmphases(),a.criteriaEmphases=a.critEmphInternal,b.registerInternalWatch())},!0),b.registerInternalWatch()}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("criteriaEmphasis",[function(){"use strict";
var a;return a={criteriaEmphases:"=",indicatorMap:"="},{scope:a,restrict:"E",templateUrl:"templates/criteriaEmphasesTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.criteriaEmphasesController"}}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.DecisionStrategyDirectiveController",["$scope","de.cismet.crisma.ICMM.Worldstates",function(a,b){"use strict";var c;c=this,this.extractIndicators=function(c){var d,e,f,g,h,i;if(i={},a.indicatorSize=0,c&&c.length>0)for(h=0;h<c.length;h++){f=b.utils.stripIccData([c[h]],!1)[0];for(d in f.data)if(f.data.hasOwnProperty(d)){g=f.data[d];for(e in g)g.hasOwnProperty(e)&&"displayName"!==e&&"iconResource"!==e&&(i[e]||(i[e]=g[e],a.indicatorSize++))}}return i},a.decisionStrategy=a.decisionStrategy||{},a.indicatorSize=a.indicatorSize||0,a.indicatorMap=a.indicatorMap||{},a.$watch("worldstates",function(){a.indicatorMap=c.extractIndicators(a.worldstates)},!0)}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("decisionStrategy",[function(){"use strict";var a;return a={worldstates:"=",decisionStrategy:"="},{scope:a,restrict:"E",templateUrl:"templates/decisionStrategyTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.DecisionStrategyDirectiveController"}}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.decisionStrategyManagerDirectiveController",["$scope","de.cismet.crisma.ICMM.Worldstates",function(a,b){"use strict";a.editable=[],a.currentIntervalFunctions=[],a.selectedDecisionStrategyIndex=-1,a.tooltipDelete={title:"Delete this decision strategy"},a.tooltipAdd={title:"Create a new decision strategy"},a.tooltipSave={title:"Save changes"},a.tooltipRename={title:"Rename decision strategy"},a.tooltipRenameDone={title:"Done"},a.addDecisionStrategy=function(){var b,c=[];for(b=0;b<a.worldstates.length;b++)c.push({indicator:a.worldstates[b].displayName});a.decisionStrategies.push({name:"Decision Strategy "+(a.decisionStrategies.length+1)}),a.editable.push(!1)},a.removeDecisionStrategy=function(){a.decisionStrategies.splice(a.selectedDecisionStrategyIndex,1)},a.isActiveItem=function(b){return a.selectedDecisionStrategyIndex===b?"list-group-item-info":""},a.setSelectedDecisionStrategy=function(b){a.selectedDecisionStrategyIndex=b,a.currentDecisionStrategy=a.decisionStrategies[a.selectedDecisionStrategyIndex]},a.updateModel=function(){var c,d,e,f,g;for(a.indicatorVector=[],c=0;c<a.worldstates.length;c++){f=b.utils.stripIccData([a.worldstates[c]],!1)[0];for(d in f.data)if(f.data.hasOwnProperty(d)){g=f.data[d];for(e in g)g.hasOwnProperty(e)&&"displayName"!==e&&"iconResource"!==e&&a.indicatorVector.push(g[e])}}},a.worldstates=a.worldstates||[],a.$watch("worldstates",function(){a.updateModel()},!0)}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("decisionStrategyManager",[function(){"use strict";var a;return a={worldstates:"=",decisionStrategies:"="},{scope:a,restrict:"E",templateUrl:"templates/decisionStrategyManagerTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.decisionStrategyManagerDirectiveController"}}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.worldstateRankingTableDirectiveController",["$scope","$filter","ngTableParams","de.cismet.crisma.ICMM.Worldstates","eu.crismaproject.worldstateAnalysis.services.CriteriaCalculationService","eu.crismaproject.worldstateAnalysis.services.AnalysisService","ngDialog",function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m;h=function(a){var b,c;c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b);return c.sort(),c},l=function(a){var b,c,e,f,g;if(g=[],a){e=d.utils.stripIccData([a],!1)[0];for(b in e.data)if(e.data.hasOwnProperty(b)){f=e.data[b];for(c in f)f.hasOwnProperty(c)&&"displayName"!==c&&"iconResource"!==c&&g.push(f[c])}}return g},k=function(a,b){var c,d,f;if(c=l(a),d=[],c&&c.length===b.criteriaFunctions.length)for(f=0;f<c.length;f++)b.criteriaFunctions.forEach(function(a){a.indicator===c[f].displayName&&d.push({indicator:c[f],criteria:e.calculateCriteria(c[f].value,a)/100})});return d},m=function(a,b){var c,d,e;for(c={},c.criteria=[],c.weights=[],d=0;d<a.criteriaEmphases.length;d++)e=a.criteriaEmphases[d],b.forEach(function(a){a.indicator.displayName===e.indicator.displayName&&(c.criteria.push(a.criteria),c.weights.push(e.criteriaEmphasis/100))});return c},j=function(a,b,c){var d,e,g,h,i,j,l;for(j=[],d=0;d<a.length;d++)e=a[d],g=k(e,b),i=m(c,g),h=f.getOwa().aggregateLS(i.criteria,c.satisfactionEmphasis,i.weights),0===j.length?j.push({worldstate:e,score:h}):(l=-1,j.forEach(function(a,b){-1===l&&a&&a.score&&h<=a.score&&(l=b)}),-1!==l?j.splice(l,0,{worldstate:e,score:h}):j.push({worldstate:e,score:h}));return j=j.reverse(),j.forEach(function(a,b){a.rank=b+1}),j},a.clickToOpen=function(b){a.ws=a.tableData[b].ws,g.open({template:"templates/criteriaRadarPopupTemplate.html",scope:a,className:"ngdialog-theme-default ngdialog-theme-custom ngdialog-theme-width"})},i=function(){var f,g,h,i,k,m,n,o,p,q;if(a.criteriaFunction&&a.decisionStrategy&&a.worldstates&&a.worldstates.length>0){if(q=[],f=j(a.worldstates,a.criteriaFunction,a.decisionStrategy),!f&&f.length<=0)throw new Error("Could not rank the worldstates...");if(a.tooltip={checked:!1},a.tooltip.title="",a.tableData=[],a.showRadarChart){var r=l(a.worldstates[0]);for(g=0;g<r.length;g++)a.tooltip.title=a.tooltip.title+"<br/>"+(g+1)+": "+r[g].displayName}for(a.columns=[{title:"Rank",field:"rank"},{title:"Worldstate",field:"worldstate"},{title:"Score",field:"score"}],g=0;g<f.length;g++){if(h={rank:f[g].rank,worldstate:f[g].worldstate.name,ws:f[g].worldstate,score:b("number")(100*f[g].score,2)+" %"},a.showIndicators){i=d.utils.stripIccData([f[g].worldstate])[0].data;for(k in i)if(i.hasOwnProperty(k)){m=i[k];for(n in m)m.hasOwnProperty(n)&&"displayName"!==n&&"iconResource"!==n&&(o=m[n],p=0,a.criteriaFunction.criteriaFunctions.forEach(function(a){a.indicator===o.displayName&&(p=e.calculateCriteria(o.value,a))}),h[o.displayName]={indicator:b("number")(o.value)+" "+o.unit,los:b("number")(p,2)+" % LoS"},-1===q.indexOf(o.displayName)&&(q.push(o.displayName),a.columns.push({title:a.showRadarChart?o.displayName+" ("+(a.columns.length-2)+")":o.displayName,field:o.displayName})))}}a.tableData.push(h)}a.tableParams?a.tableParams.reload():a.tableParams=new c({page:1,count:1e3,sorting:{name:"asc"}},{counts:[],total:1,getData:function(c,d){var e=d.sorting()?b("orderBy")(a.tableData,d.orderBy()):a.tableData;d.total(e.length),c.resolve(a.tableData.slice((d.page()-1)*d.count(),d.page()*d.count()))}})}},a.tableVisibleSwitch="0",a.$watch("worldstates",function(){a.worldstates&&a.worldstates.length>0&&i()},!0),a.$watch("decisionStrategy",function(b,c){b!==c&&a.worldstates&&a.worldstates.length>0&&i()},!0),a.$watch("criteriaFunction",function(b,c){b!==c&&a.worldstates&&a.worldstates.length>0&&i()},!0),a.$watch("showIndicators",function(b,c){b!==c&&a.worldstates&&a.worldstates.length>0&&i()}),a.$watch("showRadarChart",function(b,c){b!==c&&a.worldstates&&a.worldstates.length>0&&i()})}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("worldstateRankingTable",[function(){"use strict";var a;return a={worldstates:"=",criteriaFunction:"=",decisionStrategy:"=",showIndicators:"=",showRadarChart:"="},{scope:a,restrict:"E",templateUrl:"templates/worldstateRankingTableTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.worldstateRankingTableDirectiveController"}}]),angular.module("eu.crismaproject.worldstateAnalysis.controllers").controller("eu.crismaproject.worldstateAnalysis.controllers.indicatorBarChartDirectiveController",["$scope","de.cismet.crisma.ICMM.Worldstates","$filter",function(a,b,c){"use strict";var d,e;d=this,e=d3.format(".3s"),this.createChartModels=function(){var c,d,e,f,g,h;for(d={},c=0;c<a.worldstates.length;c++){e=b.utils.stripIccData([a.worldstates[c]])[0].data;for(g in e)if(e.hasOwnProperty(g)){f=e[g];for(h in f)f.hasOwnProperty(h)&&"displayName"!==h&&"iconResource"!==h&&(d[h]||(d[h]={key:f[h].displayName,forceY:[0,0],values:[]}),parseInt(f[h].value)>d[h].forceY&&(d[h].forceY[1]=parseInt(f[h].value)),d[h].values.push([a.worldstates[c].name,parseInt(f[h].value)]))}}var i=[];for(e in d)d.hasOwnProperty(e)&&i.push([d[e]]);a.chartModels=i};var f=d3.scale.category20().range();a.colorFunction=function(){return function(a,b){return f[b%f.length]}},a.yAxisTickFormat=function(a){var b=e(a);return b.replace("M","Mio").replace("G","Mrd").replace("T","B")},a.toolTipContentFunction=function(){return function(a,b,d,e){return'<h3 style="font-weight:normal; font-size:18px">'+b+"</h3><p>"+a+": "+c("number")(e.value)+"</p>"}},a.getLegendColor=function(b){return{color:a.colorFunction()(0,b)}},a.$watch("worldstates",function(){a.worldstates&&a.worldstates.length>0&&d.createChartModels()},!0)}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").directive("indicatorBarCharts",[function(){"use strict";var a;return a={worldstates:"="},{scope:a,restrict:"E",templateUrl:"templates/indicatorBarChartTemplate.html",controller:"eu.crismaproject.worldstateAnalysis.controllers.indicatorBarChartDirectiveController"}}]),angular.module("eu.crismaproject.worldstateAnalysis.directives").run(["$templateCache",function(a){"use strict";a.put("templates/criteriaEmphasesTemplate.html",'<div class="panel panel-default">\n    <div class="panel-heading" style="white-space: nowrap;\n         overflow: hidden;\n         text-overflow: ellipsis">\n        Criteria Emphasis\n    </div>\n    <div class="panel-body">\n        <div class="row">\n\n            <div class="col-lg-2 col-md-2 col-sm-2 col-xs-4" style="margin-bottom: 20px" ng-repeat="item in critEmphInternal">\n                <div class="row">\n                    <div style="display:block;margin:0 auto;width:100px">\n                        <knob knob-data="item.criteriaEmphasis" knob-max="knobMax" knob-options="knobOptions"></knob>\n                    </div>\n                </div>\n                <div class="row">\n                    <div style="display:block;margin:0 auto;width:100px;text-align: center">\n                        <span>{{item.indicator.displayName}}</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'),a.put("templates/criteriaFunctionManagerTemplate.html",'<div class="col-lg-12">\n    <div class="row">\n        <div class="col-lg-3">\n            <div class="row">\n                <div class="btn-group" style="margin-bottom: 10px">\n\n                </div>\n            </div>\n            <div class="row">\n                <div class="list-group">\n                    <a class="list-group-item active">\n                        Criteria Functions \n                        <i data-placement="top" data-type="info" data-delay="500" data-container="body" data-animation="am-fade-and-scale" bs-tooltip="tooltipSave.title" ng-click="addCriteriaFunction()" class="pull-right glyphicon glyphicon-plus-sign"></i>\n                    </a>\n                    <a class="list-group-item" ng-click="setSelectedCriteriaFunction($index)" ng-class="isActiveItem($index)" ng-repeat="cf in criteriaFunctionSet">\n                        <span ng-hide="editable[$index]">{{cf.name}}</span>\n                        <input style="color:black" ng-hide="!editable[$index]" type="text" ng-model="cf.name">\n                        <div class="pull-right" ng-hide="$index!==selectedCriteriaFunctionIndex">\n\n                            <i ng-hide="editable[$index]" data-placement="top" data-type="info" data-delay="500" data-animation="am-fade-and-scale" data-container="body" bs-tooltip="tooltipRename.title" ng-click="editable[$index] = true" style="margin-right: 10px" class="glyphicon glyphicon-pencil"></i>\n                            <i ng-hide="!editable[$index]" data-placement="top" data-type="info" data-delay="500" data-animation="am-fade-and-scale" data-container="body" bs-tooltip="tooltipRenameDone.title" ng-click="editable[$index] = false" style="margin-right: 10px" class="glyphicon glyphicon-ok"></i>\n<!--                            <i data-placement="bottom" data-type="info" data-delay="500" data-animation="am-fade-and-scale" bs-tooltip="tooltipSave.title"\n                               ng-click="saveCriteriaFunctions()"\n                               style="margin-right: 10px;"\n                               class="glyphicon glyphicon-floppy-disk"></i>-->\n                            <i data-placement="top" data-type="info" data-delay="500" data-animation="am-fade-and-scale" bs-tooltip="tooltipSave.title" data-container="body" ng-click="removeCriteriaFunction()" class="glyphicon glyphicon-minus-sign"></i>\n                        </div>\n                    </a>\n                </div>\n            </div>\n        </div>\n        <div class="col-lg-9" ng-if="selectedCriteriaFunctionIndex >= 0 && criteriaFunctionSet[selectedCriteriaFunctionIndex]">\n            <div class="row" ng-repeat="indicator in indicators">\n                <div class="col-lg-12">\n                    <div class="row">\n                        <div class="col-lg-12 vCenter">\n                            <img ng-src="{{indicator.iconResource}}" style="margin-right:5px;margin-bottom: 5px"> <label>{{indicator.displayName}}</label>\n                        </div>\n                    </div>\n                    <div class="row">\n                        <div class="col-lg-12">\n                            <indicator-band criteria-function="criteriaFunctionSet[selectedCriteriaFunctionIndex].criteriaFunctions[$index]"></indicator-band>        \n                        </div>\n                    </div>\n                </div>   \n            </div>\n        </div>\n    </div>\n</div>'),a.put("templates/criteriaRadarPopupTemplate.html",'<div class="ngdialog-message" style="width:500px;min-width: 500px" criteria-radar worldstates="[ws]" show-legend="false" show-axis-text="true" use-numbers="false" criteria-function="criteriaFunction">>\n</div>'),a.put("templates/decisionStrategyManagerTemplate.html",'<div class="col-lg-12">\n    <div class="row">\n        <div class="col-lg-3">\n            <div class="row">\n                <div class="list-group">\n                    <a class="list-group-item active">\n                        Decision Strategies\n                        <i data-placement="top" data-type="info" data-delay="500" data-container="body" data-animation="am-fade-and-scale" bs-tooltip="tooltipSave.title" ng-click="addDecisionStrategy()" class="pull-right glyphicon glyphicon-plus-sign"></i>\n                    </a>\n                    <a class="list-group-item" ng-click="setSelectedDecisionStrategy($index)" ng-class="isActiveItem($index)" ng-repeat="cf in decisionStrategies">\n                        <span ng-hide="editable[$index]">{{cf.name}}</span>\n                        <input style="color:black" ng-hide="!editable[$index]" type="text" ng-model="cf.name">\n                        <div class="pull-right" ng-hide="$index !== selectedDecisionStrategiesIndex">\n\n                            <i ng-hide="editable[$index]" data-placement="top" data-type="info" data-delay="500" data-animation="am-fade-and-scale" data-container="body" bs-tooltip="tooltipRename.title" ng-click="editable[$index] = true" style="margin-right: 10px" class="glyphicon glyphicon-pencil"></i>\n                            <i ng-hide="!editable[$index]" data-placement="top" data-type="info" data-delay="500" data-animation="am-fade-and-scale" data-container="body" bs-tooltip="tooltipRenameDone.title" ng-click="editable[$index] = false" style="margin-right: 10px" class="glyphicon glyphicon-ok"></i>\n                            <i data-placement="top" data-type="info" data-delay="500" data-animation="am-fade-and-scale" bs-tooltip="tooltipSave.title" data-container="body" ng-click="removeDecisionStrategy()" class="glyphicon glyphicon-minus-sign"></i>\n                        </div>\n                    </a>\n                </div>\n            </div>\n        </div>\n        <div class="col-lg-9" ng-if="selectedDecisionStrategyIndex >= 0 && decisionStrategies[selectedDecisionStrategyIndex]">\n            <decision-strategy worldstates="worldstates" decision-strategy="currentDecisionStrategy">\n\n            </decision-strategy>\n        </div>\n    </div>\n</div>\n'),a.put("templates/decisionStrategyTemplate.html",'<div>\n    <div class="col-lg-3">\n        <level-of-emphasis satisfaction-emphasis="decisionStrategy.satisfactionEmphasis" indicator-size="indicatorSize">\n        </level-of-emphasis>\n    </div>\n    <div class="col-lg-9">\n        <div class="row">\n            <criteria-emphasis indicator-map="indicatorMap" criteria-emphases="decisionStrategy.criteriaEmphases">\n                \n            </criteria-emphasis>\n        </div>\n    </div>\n</div>'),a.put("templates/indicatorBandItemTemplate.html",'<div id="popover-parent" class="progress-bar table-display" aria-valuemin="0" aria-valuemax="100" aria-valunow="{{getPercent()}}" ng-style="intervalWidth()" ng-class="getColorClass()" ng-click="togglePopover($event)" style="cursor: pointer">\n    <div class="closeIcon vCenter" ng-if="!lowerBoundary && !upperBoundary"><i ng-click="del(previousInterval);\n                $event.stopPropagation()" ng-hide="first" class="glyphicon glyphicon-remove"></i></div>\n    <div id="popover-target" class="vCenter" style="width:100%">\n        <div ng-hide="actualHeightExceeded" class="progress-labels" style="width:100%">\n\n            <span ng-if="lowerBoundary">0%</span>\n            <span ng-if="upperBoundary">100%</span>\n            <span ng-if="!lowerBoundary && !upperBoundary">{{previousInterval.criteriaValue||\'0\' | number}}% - {{interval.criteriaValue| number}}% </span>\n            <br> \n            <span ng-if="lowerBoundary">&gt;=</span>\n            <span ng-if="upperBoundary">&lt;=</span>\n            <span ng-if="!lowerBoundary && !upperBoundary">{{previousInterval.indicatorValue||\'0\' | number}} -</span>\n            <span>{{interval.indicatorValue| number}}</span>\n        </div>\n        <div ng-hide="!actualHeightExceeded">\n            <i class="glyphicon glyphicon-info-sign" style="color:black" data-placement="top" data-type="info" data-animation="am-fade-and-scale" bs-tooltip="tooltip"></i>\n        </div>\n    </div>\n    <div class="closeIcon vCenter" ng-if="!lowerBoundary && !upperBoundary"><i ng-click="del(interval);\n                $event.stopPropagation()" ng-hide="last" class="glyphicon glyphicon-remove"></i>\n    </div>\n</div>'),a.put("templates/indicatorBandPopoverContentTemplate.html",'<form role="form">\n    <div class="form-group">\n        <label for="exampleInputEmail1">Level of satisfaction</label>\n        <input ng-model="popOverItem.criteriaValue" ng-disabled="lowerBoundary || upperBoundary" type="text" class="form-control" placeholder="Level of satisfactory">\n    </div>\n    <div class="form-group">\n        <label for="exampleInputPassword1">Indicator value</label>\n        <input ng-model="popOverItem.indicatorValue" type="text" class="form-control" placeholder="Indicator Value">\n    </div>\n    <button type="submit" class="btn btn-default" ng-click="updateInterval($event);\n                $hide()">Save</button>\n</form>'),a.put("templates/indicatorBandPopoverTemplate.html",'<div class="popover" style="color:black" ng-click="$event.stopPropagation();">\n  <div class="arrow"></div>\n  <h3 class="popover-title" ng-bind="title" ng-show="title"></h3>\n  <div class="popover-content" ng-bind="content"></div>\n</div>'),a.put("templates/indicatorBandTemplate.html",'<div class="row">\n    <div class="col-lg-12">\n        <div class="row">\n            <div class="col-lg-2" style="padding-right:5px;width:12.5%">\n                <div class="progress">\n                    <indicator-band-item interval="criteriaFunction.lowerBoundary" lower-boundary="true" on-interval-changed="updateLowerBoundary(indicatorValue)" title="Criteria / Indicator values">\n                    </indicator-band-item>\n                </div>\n            </div>\n            <div class="col-lg-9">\n                <div class="row">\n                    <div class="progress">\n                        <indicator-band-item ng-repeat="interval in criteriaFunction.intervals" interval="interval" previous-interval="$first ? criteriaFunction.lowerBoundary : criteriaFunction.intervals[$index-1]" first="$first" delete-interval="deleteInterval(interval)" on-interval-changed="createInterval(criteriaValue,indicatorValue)" get-color="getIntervalColor(interval)">\n                        </indicator-band-item>\n                        <indicator-band-item interval="criteriaFunction.upperBoundary" previous-interval="criteriaFunction.intervals[criteriaFunction.intervals.length-1] || criteriaFunction.lowerBoundary" last="true" first="criteriaFunction.intervals.length<=0" on-interval-changed="createInterval(criteriaValue,indicatorValue)" get-color="getIntervalColor(interval)">\n                        </indicator-band-item>\n                    </div>\n                </div>\n                <div class="row" style="min-height: 20px">\n                    <div class="intervalMarker" ng-style="getIntervalWidth(interval, criteriaFunction.intervals[$index - 1])" ng-repeat="interval in criteriaFunction.intervals">\n                        <span class="glyphicon glyphicon-chevron-up" style="width:16px;float:right;margin-right: -8px"></span>\n                    </div>\n                </div>\n            </div>\n            <div class="col-lg-2" style="padding-left:5px;width: 12.5%">\n                <div class="progress">\n                    <indicator-band-item interval="criteriaFunction.upperBoundary" upper-boundary="true" on-interval-changed="updateUpperBoundary(indicatorValue)" title="Criteria / Indicator values">\n                    </indicator-band-item>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'),a.put("templates/indicatorBarChartTemplate.html",'<div>\n    <div class="row" ng-if="!worldstates || worldstates.length <= 0">\n        <div class="col-lg-12">\n            <div ng-hide="worldstates.length > 0" class="alert alert-warning">\n                <strong>Warning: </strong>There are no worldstates selected.\n            </div>\n        </div>\n    </div>\n    <div class="row" ng-if="worldstates && worldstates.length > 0">\n        <div class="col-lg-12" style="text-align: center; margin: 20px 0px">\n            <span ng-repeat="ws in worldstates" style="margin:0px 10px">\n                <i class="glyphicon glyphicon-stop" ng-style="getLegendColor($index)"></i>{{ws.name}}\n            </span>\n        </div>\n    </div>\n    <div class="row" ng-if="worldstates && worldstates.length > 0">\n        <div class="col-lg-4" ng-repeat="chartModel in chartModels">\n            <div class="row">\n                <div class="col-lg-12" style="text-align: center">\n                    <label>{{chartModel[0].key}}</label>\n                </div>\n            </div>\n            <div class="row">\n                <div class="col-lg12" nvd3-discrete-bar-chart style="margin-top: -40px" data="chartModel" width="400" height="200" showxaxis="false" showyaxis="true" interactive="true" showvalues="true" staggerlabels="true" forcey="{{chartModel.forceY}}" yaxistickformat="yAxisTickFormat" valueformat="yAxisTickFormat" color="colorFunction()" tooltips="true" tooltipcontent="toolTipContentFunction()">\n                    <svg></svg>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>'),a.put("templates/indicatorCriteriaAxisChooserTemplate.html",'<div class="btn-group">\n    <button type="button" class="btn btn-default btn-sm"> <img ng-src="{{selectedAxis.icon}}" style="margin-right:5px;float:left">{{selectedAxis.name}}</button>\n    <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown">\n        <span class="caret"></span>\n        <span class="sr-only">Toggle Dropdown</span>\n    </button>\n    <ul class="dropdown-menu" role="menu">\n        <li ng-repeat="scale in scales" role="presentation" ng-click="axisSelected($index)" ng-class="{\'dropdown-header\':scale.isGroup}">\n            <a ng-if="!scale.isGroup">{{scale.name}}</a>\n            <img ng-if="scale.isGroup" ng-src="{{scale.icon}}" style="margin-right:5px;float:left">\n            <span ng-if="scale.isGroup" style="margin-top: 4px">{{scale.name}}</span>\n        </li>\n    </ul>\n</div>'),a.put("templates/indicatorCriteriaTableTemplate.html",'<div id="indicatorCriteriaTable">\n    <div ng-hide="worldstates.length > 0" class="alert alert-warning">\n        <strong>Warning: </strong>There are no worldstates selected.\n    </div>\n    <table ng-hide="worldstates.length <= 0" data-ng-table="tableParams" class="table" template-pagination="templates/nopager.html">\n        <thead>\n            <tr>\n                <th ng-repeat="column in columns" class="text-left" ng-style="getCellStyle($index)">\n                    {{column.title}}\n                </th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr data-ng-repeat="row in $data" ng-class="{\'info\':isGroupRow(row)}" ng-style="getRowStyle($index)">\n                <td data-ng-repeat="col in columns" ng-style="getCellStyle($index)">\n                    <img ng-if="isGroupRow(row) || detailIcons" ng-src="{{row[col.field].icon}}">\n                    {{row[col.field].name}}\n                </td>\n            </tr>\n        </tbody>\n    </table>  \n</div>'),a.put("templates/levelOfEmphasisTemplate.html",'<div class="panel panel-default">\n    <div class="panel-heading" style="white-space: nowrap;\n         overflow: hidden;\n         text-overflow: ellipsis">\n        Level of satisfaction emphasis {{model.lse}}\n    </div>\n    <div class="panel-body">\n        <div ng-if="!expertMode && indicatorSize>=1">\n            <form name="myForm">\n\n                <div class="radio">\n                    <label>\n                        <input type="radio" ng-model="model.lse" value="2">\n                        only positive\n                    </label>\n                </div>\n                <div class="radio">\n                    <label>\n                        <input type="radio" ng-model="model.lse" value="1">\n                        over-emphasise positives\n                    </label>\n                </div>\n                <div class="radio">\n                    <label>\n                        <input type="radio" ng-model="model.lse" value="0" checked="true">\n                        neutral\n                    </label>\n                </div>\n                <div class="radio">\n                    <label>\n                        <input type="radio" ng-model="model.lse" value="-1">\n                        over-emphasise negatives\n                    </label>\n                </div>\n                <div class="radio">\n                    <label>\n                        <input type="radio" ng-model="model.lse" value="-2">\n                        only negative\n                    </label>\n                </div>\n            </form>\n        </div>\n        <div ng-if="expertMode">\n            <div class="alert alert-warning" role="alert">Expert Mode not yet implemented!</div>    \n        </div>\n    </div>\n</div>'),a.put("templates/nopager.html",""),a.put("templates/relationAnalysisChartTemplate.html",'<div class="col-lg-12">\n    <style>\n        .nvd3 .nv-axis.nv-x path.domain {\n            stroke-opacity: .75;\n        }\n    </style>\n    <div ng-hide="worldstates().length > 0" class="row">\n        <!--two dropdowns for x and y axis-->\n        <div class="alert alert-warning">\n            <strong>Warning: </strong>There are no worldstates selected.\n        </div>\n    </div>\n    <div ng-hide="!(worldstates() && worldstates().length>0)" class="row">\n        <!--two dropdowns for x and y axis-->\n        <div style="float: right;margin-bottom: 10px">\n            <indicator-criteria-axis-chooser is-x-axis="false" icc-object="iccObject" selected-axis="yAxis"></indicator-criteria-axis-chooser>\n            <indicator-criteria-axis-chooser is-x-axis="true" icc-object="iccObject" selected-axis="xAxis"></indicator-criteria-axis-chooser>\n        </div>\n    </div>\n    <div ng-hide="!(worldstates() && worldstates().length>0)" class="row"> \n        <!--chart-->\n        <div class="col-lg-12" nvd3-scatter-chart data="chartdata" showlegend="true" interactive="true" tooltips="true" sizerange="[80,80]" zscale="zScale" showdistx="true" showdisty="true" xaxislabel="{{xAxis.name}}" yaxislabel="{{yAxis.name}}" margin="{left:90,top:0,bottom:50,right:50}" yaxistickformat="yAxisTickFormatFunction()" xaxistickformat="xAxisTickFormatFunction()" height="{{chartHeight}}">\n            <svg></svg>\n        </div>\n    </div>\n</div>'),a.put("templates/worldstateAnalysisWidgetTemplate.html",'<div class="col-lg-12">\n    <div class="row">\n        <div class="panel panel-default">\n            <div class="panel-heading">\n                <span class="pull-left">\n                    <!--<i class="glyphicon glyphicon-list-alt"></i>-->\n                    <h3 style="display:inline" class="panel-title" ng-if="!forCriteriaTable">Indicator table</h3>\n                    <h3 style="display:inline" class="panel-title" ng-if="forCriteriaTable">Criteria table</h3>\n                </span>\n                <span class="pull-right">\n                    <div class="btn-group">\n                        <button type="button" class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown" ng-disabled="disabled">\n                            Change Mode <span class="caret"></span>\n                        </button>\n                        <ul class="dropdown-menu" role="menu">\n                            <li><a ng-click="forCriteriaTable = false"><i ng-show="!forCriteriaTable" class="glyphicon glyphicon-ok-circle"></i> <span ng-style="{\'padding-left\' : !forCriteriaTable? \'0px\': \'19px\'}">Indicator</span></a></li>\n                            <li><a ng-click="forCriteriaTable = true"><i ng-show="forCriteriaTable" class="glyphicon glyphicon-ok-circle"> </i>  <span ng-style="{\'padding-left\' : forCriteriaTable? \'0px\': \'19px\'}">Criteria</span></a></li>\n                        </ul>\n                    </div>\n                </span>\n                <span class="clearfix"></span>\n            </div>\n            <div class="panel-body">\n                <indicator-criteria-table worldstates="worldstates" for-criteria="forCriteriaTable" criteria-function="selectedCriteriaFunction">\n\n                </indicator-criteria-table>\n            </div>\n        </div>\n    </div>\n    <!-- end widget -->\n\n    <div class="row">\n        <div class="panel panel-default">\n            <div class="panel-heading">\n                <span class="pull-left">\n                    <!--<span class="widget-icon"> <i class="fa fa-table"></i> </span>-->\n                    <h3 style="display:inline" class="panel-title">Worldstate relation analysis chart</h3>\n                </span>\n                <span class="pull-right">\n                    <div class="btn-group">\n                        <button type="button" class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown" ng-disabled="disabled">\n                            Change Mode <span class="caret"></span>\n                        </button>\n                        <ul class="dropdown-menu" role="menu">\n                            <li><a ng-click="isCriteria = false"><i ng-show="!isCriteria" class="glyphicon glyphicon-ok-circle"></i> <span ng-style="{\'padding-left\' : !isCriteria? \'0px\': \'19px\'}">Indicator</span></a></li>\n                            <li><a ng-click="isCriteria = true"><i ng-show="isCriteria" class="glyphicon glyphicon-ok-circle"> </i>  <span ng-style="{\'padding-left\' : isCriteria? \'0px\': \'19px\'}">Criteria</span></a></li>\n                        </ul>\n                    </div>\n                </span>\n                <span class="clearfix"></span>\n            </div>\n            <div class="panel-body">\n                <relation-analysis-chart style="padding-left:50px" height="350" for-criteria="isCriteria" worldstates="worldstates" criteria-function="selectedCriteriaFunction">\n                </relation-analysis-chart>\n            </div>\n        </div>\n    </div>\n\n    <div class="row">\n        <div class="panel panel-default">\n            <div class="panel-heading">\n                <span class="pull-left">\n                    <!--<span class="widget-icon"> <i class="fa fa-table"></i> </span>-->\n                    <h3 style="display:inline" class="panel-title">Criteria radar chart comparison</h3>\n                </span>\n                <span class="pull-right">\n\n                </span>\n                <span class="clearfix"></span>\n            </div>\n            <div class="panel-body">\n                <div class="col-lg-3">\n                    <select multiple="multiple" ng-model="worldstateRef" ng-options="ws.name for ws in allWorldstates" style="width: 100%;height: 100%">\n                    </select>\n                </div>\n                <div class="col-lg-9">\n                    <div class="row">\n                        <div class="col-lg-4" ng-repeat="chartModel in chartModels">\n                            <div class="panel panel-default">\n                                <div class="panel-heading">\n                                    <h3 class="panel-title ng-binding">\n                                        <i class="fa fa-globe"></i>\n                                        {{chartModel[0].name}}</h3>\n                                </div>\n                                <div class="panel-body no-padding text-align-center">\n                                    <div style="margin: 0 auto; padding-top: 20px" criteria-radar worldstates="chartModel" criteria-function="selectedCriteriaFunction">\n                                    </div>\n                                </div>\n                                <!--                            <div class="panel-footer no-padding">\n                                                            </div>-->\n                            </div>\n\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="row">\n        <div class="panel panel-default">\n            <div class="panel-heading" style="display:table;width:100%">\n                <h3 style="display:table-cell;vertical-align: middle" class="panel-title">Criteria functions</h3>\n                <div class="pull-right">\n\n                    <div class="input-group">\n                        <div class="input-group-btn" style="display: block" ng-click="persistCriteriaFunctions()">\n                            <button type="button" class="btn btn-success btn-sm">\n                                Persist\n                            </button>\n                            <button type="button" class="btn btn-success btn-sm">\n                                <i ng-if="!showPersistSpinner && !showPersistDone" class="glyphicon glyphicon-floppy-disk"></i>\n                                <i ng-if="showPersistSpinner" class="spin glyphicon glyphicon-refresh"></i>\n                                <i ng-if="showPersistDone" class="glyphicon glyphicon-ok"></i>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n            <div class="panel-body">\n                <criteria-function-manager indicators="indicatorVector" criteria-functions="criteriaFunctionSets"></criteria-function-manager>\n            </div>\n        </div>\n    </div>\n</div>\n<!-- end widget -->'),a.put("templates/worldstateRankingTableTemplate.html",'<div id="indicatorCriteriaTable" style="overflow-x: auto">\n    <div ng-hide="worldstates.length > 0" class="alert alert-warning">\n        <strong>Warning: </strong>There are no worldstates selected.\n    </div>\n    <table ng-hide="worldstates.length <= 0" ng-table="tableParams" show-filter="false" class="table table-striped" style="white-space: nowrap">\n        <thead>\n            <tr>\n                <th ng-repeat="column in columns" ng-if="$index < 3" class="">\n                    {{column.title}}\n                </th>\n                <th ng-if="showRadarChart">\n                    Criteria radar\n                </th>\n                <th ng-repeat="column in columns" ng-if="$index >= 3" class="">\n                    {{column.title}}\n                </th>\n            </tr>\n        </thead>\n        <tbody>\n            <tr ng-repeat="item in $data">\n                <td ng-repeat="col in columns" ng-if="$index < 3" style="vertical-align: middle">\n                    {{item[col.field]}}\n                </td>\n                <td ng-if="showRadarChart" style="min-width:150px; width:150px; margin: 0 auto; padding-top: 20px" criteria-radar worldstates="[item.ws]" show-legend="false" show-axis-text="true" use-numbers="true" criteria-function="criteriaFunction" ng-click="clickToOpen($index)">\n                </td>\n                <td ng-repeat="col in columns" ng-if="$index >= 3" style="vertical-align: middle">\n                    <span>\n                        {{item[col.field].indicator}}\n                        <br>\n                        {{item[col.field].los}}\n                    </span>\n                </td>\n\n            </tr>\n        </tbody>\n    </table>\n</div>')
}]);